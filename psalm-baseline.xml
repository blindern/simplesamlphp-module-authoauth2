<?xml version="1.0" encoding="UTF-8"?>
<files psalm-version="5.20.0@3f284e96c9d9be6fe6b15c79416e1d1903dcfef4">
  <file src="src/AttributeManipulator.php">
    <MixedArgument>
      <code>$input</code>
    </MixedArgument>
    <MixedAssignment>
      <code>$value</code>
      <code>$value</code>
      <code>$value</code>
    </MixedAssignment>
  </file>
  <file src="src/Auth/Source/BitbucketAuth.php">
    <MixedArrayAccess>
      <code><![CDATA[$response["values"][$i]]]></code>
      <code><![CDATA[$response["values"][$i]]]></code>
      <code><![CDATA[$response["values"][$i]]]></code>
      <code><![CDATA[$response["values"][$i]["email"]]]></code>
      <code><![CDATA[$response["values"][$i]["is_primary"]]]></code>
      <code><![CDATA[$response["values"][$i]["type"]]]></code>
    </MixedArrayAccess>
    <MixedArrayAssignment>
      <code>$state['Attributes'][$prefix . 'email']</code>
    </MixedArrayAssignment>
    <MixedAssignment>
      <code>$response</code>
    </MixedAssignment>
  </file>
  <file src="src/Auth/Source/LinkedInV2Auth.php">
    <MixedArgument>
      <code>$attributes[$attributeName]['localized']</code>
    </MixedArgument>
    <MixedArrayAccess>
      <code><![CDATA[$response["elements"][0]["handle~"]["emailAddress"]]]></code>
    </MixedArrayAccess>
    <MixedArrayAssignment>
      <code>$state['Attributes'][$prefix . 'emailAddress']</code>
    </MixedArrayAssignment>
    <MixedAssignment>
      <code>$response</code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code>string|false|null</code>
    </MixedInferredReturnType>
    <MixedReturnStatement>
      <code>reset($attributes[$attributeName]['localized'])</code>
    </MixedReturnStatement>
    <RiskyTruthyFalsyComparison>
      <code>empty($value)</code>
    </RiskyTruthyFalsyComparison>
  </file>
  <file src="src/Auth/Source/MicrosoftHybridAuth.php">
    <MixedArgument>
      <code><![CDATA[$accessToken->getValues()['id_token']]]></code>
    </MixedArgument>
    <MixedArrayAssignment>
      <code>$state['Attributes'][$prefix . 'mail']</code>
      <code>$state['Attributes'][$prefix . 'name']</code>
    </MixedArrayAssignment>
  </file>
  <file src="src/Auth/Source/OAuth2.php">
    <MixedArgument>
      <code>$apiAttributes</code>
      <code>$apiUrl</code>
      <code>$config['urlResourceOwnerDetails']</code>
      <code>$config['urlResourceOwnerOptions']</code>
      <code>$idToken</code>
      <code>$state['Attributes']</code>
      <code>$templateArray</code>
    </MixedArgument>
    <MixedArgumentTypeCoercion>
      <code><![CDATA[Middleware::log(
                    new \SAML2\Compat\Ssp\Logger(),
                    new MessageFormatter("authoauth2: $providerLabel $format")
                )]]></code>
    </MixedArgumentTypeCoercion>
    <MixedArrayAccess>
      <code>$templateArray[0]</code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code>$apiAttributes</code>
      <code>$apiUrl</code>
      <code>$data</code>
      <code>$idToken</code>
      <code>$template</code>
      <code>$templateArray</code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code>AbstractProvider</code>
      <code>array</code>
      <code>string[]</code>
    </MixedInferredReturnType>
    <MixedReturnStatement>
      <code>$data</code>
      <code>$provider</code>
      <code>$provider</code>
      <code><![CDATA[$provider->getParsedResponse($apiRequest)]]></code>
    </MixedReturnStatement>
    <UnnecessaryVarAnnotation>
      <code>0|positive-int</code>
    </UnnecessaryVarAnnotation>
  </file>
  <file src="src/Auth/Source/OpenIDConnect.php">
    <MixedArgument>
      <code>$handler</code>
      <code>$id_token</code>
      <code>$state['Attributes']</code>
    </MixedArgument>
    <MixedArgumentTypeCoercion>
      <code>$key</code>
      <code>$key</code>
    </MixedArgumentTypeCoercion>
    <MixedArrayAssignment>
      <code><![CDATA[$httpClient->getConfig()['handler']]]></code>
      <code>$state['PersistentAuthData'][]</code>
    </MixedArrayAssignment>
    <MixedAssignment>
      <code>$handler</code>
      <code>$id_token</code>
      <code>$id_token</code>
      <code>$result[substr($key, 5)]</code>
      <code>$value</code>
    </MixedAssignment>
    <RiskyTruthyFalsyComparison>
      <code>!$endSessionEndpoint</code>
      <code>!$postLogoutUrl</code>
    </RiskyTruthyFalsyComparison>
  </file>
  <file src="src/Auth/Source/OrcidOIDCAuth.php">
    <MixedArrayAccess>
      <code><![CDATA[$e["email"]]]></code>
      <code><![CDATA[$e["primary"]]]></code>
      <code><![CDATA[$e["primary"]]]></code>
      <code>$state['Attributes'][$prefix . 'sub']</code>
      <code>$state['Attributes'][$prefix . 'sub'][0]</code>
    </MixedArrayAccess>
    <MixedArrayAssignment>
      <code>$state['Attributes'][$prefix . 'email']</code>
    </MixedArrayAssignment>
    <MixedAssignment>
      <code>$e</code>
      <code>$email</code>
      <code>$response</code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code>string</code>
    </MixedInferredReturnType>
    <MixedReturnStatement>
      <code>$email</code>
      <code>$email</code>
    </MixedReturnStatement>
  </file>
  <file src="src/OAuth2ResponseHandler.php">
    <MixedArgument>
      <code>$request['code']</code>
      <code>$sourceId</code>
      <code>$stateIdWithPrefix</code>
    </MixedArgument>
    <MixedAssignment>
      <code>$error</code>
      <code>$sourceId</code>
      <code>$stateIdWithPrefix</code>
    </MixedAssignment>
    <MixedOperand>
      <code>$error</code>
      <code>@$request['error_description']</code>
      <code>@$request['error_description']</code>
    </MixedOperand>
    <PossiblyNullArgument>
      <code>$request['code']</code>
    </PossiblyNullArgument>
    <PossiblyUndefinedArrayOffset>
      <code>$request['code']</code>
    </PossiblyUndefinedArrayOffset>
  </file>
  <file src="src/OIDCLogoutHandler.php">
    <MixedArgument>
      <code>$sourceId</code>
      <code>$sourceId</code>
      <code>$stateIdWithPrefix</code>
    </MixedArgument>
    <MixedAssignment>
      <code>$sourceId</code>
      <code>$sourceId</code>
      <code>$stateIdWithPrefix</code>
    </MixedAssignment>
  </file>
  <file src="src/Providers/AdjustableGenericProvider.php">
    <MixedAssignment>
      <code>$toAdd[$param]</code>
    </MixedAssignment>
  </file>
  <file src="src/Providers/OpenIDConnectProvider.php">
    <MixedArgument>
      <code>$key</code>
      <code>$key</code>
      <code>$key['e']</code>
      <code>$key['n']</code>
      <code>$result['id_token']</code>
    </MixedArgument>
    <MixedArgumentTypeCoercion>
      <code>$keys</code>
    </MixedArgumentTypeCoercion>
    <MixedArrayAccess>
      <code>$key['e']</code>
      <code>$key['kid']</code>
      <code>$key['kty']</code>
      <code>$key['n']</code>
      <code>$key['x5c']</code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code>$error</code>
      <code>$key</code>
      <code>$key</code>
    </MixedAssignment>
    <MixedOperand>
      <code>$config['issuer']</code>
      <code>$x5c[0]</code>
    </MixedOperand>
    <RiskyTruthyFalsyComparison>
      <code>!$e</code>
      <code>!$n</code>
      <code>$error</code>
      <code><![CDATA[$this->pkceMethod]]></code>
    </RiskyTruthyFalsyComparison>
  </file>
  <file src="tests/config/authsources.php">
    <UnusedVariable>
      <code>$config</code>
    </UnusedVariable>
  </file>
  <file src="tests/config/config.php">
    <UnusedVariable>
      <code>$config</code>
    </UnusedVariable>
  </file>
  <file src="tests/config/ssp2_0-config.php">
    <UnusedVariable>
      <code>$config</code>
    </UnusedVariable>
  </file>
  <file src="tests/lib/AttributeManipulatorTest.php">
    <MissingReturnType>
      <code>testPrefixAndFlatten</code>
    </MissingReturnType>
  </file>
  <file src="tests/lib/Auth/Source/LinkedInV2AuthTest.php">
    <MissingReturnType>
      <code>getEmailProvider</code>
      <code>testAttributeConversion</code>
      <code>testGettingEmail</code>
    </MissingReturnType>
    <MixedInferredReturnType>
      <code>array</code>
    </MixedInferredReturnType>
    <MixedMethodCall>
      <code>method</code>
      <code>willReturn</code>
      <code>willReturn</code>
      <code>with</code>
      <code>with</code>
    </MixedMethodCall>
    <PossiblyInvalidArgument>
      <code>$mock</code>
      <code>$mock</code>
    </PossiblyInvalidArgument>
    <PossiblyUndefinedMethod>
      <code>expects</code>
      <code>method</code>
      <code>method</code>
    </PossiblyUndefinedMethod>
  </file>
  <file src="tests/lib/Auth/Source/MicrosoftHybridAuthTest.php">
    <MissingReturnType>
      <code>combineOidcAndGraphProfileProvider</code>
      <code>testCombineOidcAndGraphProfile</code>
    </MissingReturnType>
    <MixedMethodCall>
      <code>willReturn</code>
      <code>willReturn</code>
      <code>willReturn</code>
      <code>willReturn</code>
      <code>with</code>
      <code>with</code>
      <code>with</code>
      <code>with</code>
    </MixedMethodCall>
    <PossiblyInvalidArgument>
      <code>$mock</code>
    </PossiblyInvalidArgument>
    <PossiblyUndefinedMethod>
      <code>method</code>
      <code>method</code>
      <code>method</code>
      <code>method</code>
    </PossiblyUndefinedMethod>
  </file>
  <file src="tests/lib/Auth/Source/OAuth2Test.php">
    <DeprecatedMethod>
      <code>getConfig</code>
    </DeprecatedMethod>
    <MissingParamType>
      <code>$accessToken</code>
      <code>$accessToken</code>
      <code>$accessToken</code>
      <code>$accessToken</code>
      <code>$config</code>
      <code>$config</code>
      <code>$config</code>
      <code>$config</code>
      <code>$config</code>
      <code>$expectedAttributes</code>
      <code>$expectedAttributes</code>
      <code>$expectedAttributes</code>
      <code>$expectedAttributes</code>
      <code>$expectedUrl</code>
      <code>$state</code>
    </MissingParamType>
    <MissingPropertyType>
      <code>$module_config</code>
    </MissingPropertyType>
    <MissingReturnType>
      <code>finalStepsDataProvider</code>
      <code>finalStepsDataProviderWithAuthenticatedApiRequest</code>
      <code>testAuthenticatePerformsRedirect</code>
      <code>testConfigTemplateByName</code>
      <code>testDefaultConfigItemsSet</code>
      <code>testEnableDebugLogging</code>
      <code>testFinalSteps</code>
      <code>testFinalStepsWithAuthenticatedApiRequest</code>
      <code>testFinalStepsWithAuthenticatedApiRequestWithNetworkErrors</code>
      <code>testFinalStepsWithNetworkErrorsAndRetries</code>
      <code>testResourceOwnerQueryParamOption</code>
      <code>testTooManyErrorsForRetry</code>
    </MissingReturnType>
    <MixedArgument>
      <code>$accessToken</code>
      <code>$config</code>
      <code>$config</code>
      <code>$config</code>
      <code>$config</code>
      <code>$config</code>
      <code>$expectedUrl</code>
      <code>$state</code>
      <code>$state['Attributes']</code>
      <code>$state['Attributes']</code>
    </MixedArgument>
    <MixedArrayAccess>
      <code>$clientConfig['handler']</code>
      <code>$state['Attributes']['firstName']</code>
      <code>$state['Attributes']['firstName'][0]</code>
      <code>$state[OAuth2::AUTHID]</code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code>$clientConfig</code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code>array</code>
      <code>array</code>
    </MixedInferredReturnType>
    <MixedMethodCall>
      <code>will</code>
      <code>will</code>
      <code>will</code>
      <code>with</code>
      <code>with</code>
      <code>with</code>
    </MixedMethodCall>
    <PossiblyInvalidArgument>
      <code>$mock</code>
      <code>$mock</code>
      <code>$mockRequest</code>
      <code>$mockRequest</code>
      <code>$mockRequest</code>
      <code>$mockRequest</code>
      <code>$mockRequest</code>
    </PossiblyInvalidArgument>
    <PossiblyUndefinedMethod>
      <code>method</code>
      <code>method</code>
      <code>method</code>
    </PossiblyUndefinedMethod>
  </file>
  <file src="tests/lib/Auth/Source/OpenIDConnectTest.php">
    <InvalidClassConstantType>
      <code>AUTH_ID</code>
    </InvalidClassConstantType>
    <MissingReturnType>
      <code>testLogoutNoEndpointConfigured</code>
      <code>testLogoutNoIDTokenInState</code>
      <code>testLogoutRedirects</code>
    </MissingReturnType>
  </file>
  <file src="tests/lib/Auth/Source/OrcidOIDCAuthTest.php">
    <MixedInferredReturnType>
      <code>array</code>
    </MixedInferredReturnType>
  </file>
  <file src="tests/lib/MockOAuth2Provider.php">
    <MissingReturnType>
      <code>setDelegate</code>
    </MissingReturnType>
  </file>
  <file src="tests/lib/MockOpenIDConnectProvider.php">
    <MissingReturnType>
      <code>setConfig</code>
      <code>setSigningKeys</code>
    </MissingReturnType>
  </file>
  <file src="tests/lib/OAuth2ResponseHandlerTest.php">
    <MissingParamType>
      <code>$expectedException</code>
      <code>$expectedMessage</code>
      <code>$queryParams</code>
    </MissingParamType>
    <MissingPropertyType>
      <code>$validStateValue</code>
    </MissingPropertyType>
    <MissingReturnType>
      <code>noCodeDataProvider</code>
      <code>testNoCodeInResponse</code>
      <code>testNoStateFoundInSession</code>
      <code>testSanityCheckMocks</code>
      <code>testUnhandleableResponse</code>
      <code>testUserCancelledErrorPage</code>
      <code>testValidResponse</code>
    </MissingReturnType>
    <MixedArgument>
      <code>$expectedException</code>
      <code>$expectedMessage</code>
      <code>$queryParams</code>
    </MixedArgument>
    <MixedMethodCall>
      <code>method</code>
      <code>method</code>
      <code>method</code>
      <code>willReturn</code>
      <code>willReturn</code>
      <code>with</code>
      <code>with</code>
      <code>with</code>
    </MixedMethodCall>
    <PossiblyUndefinedMethod>
      <code>expects</code>
      <code>expects</code>
      <code>expects</code>
      <code>finalStep</code>
      <code>method</code>
      <code>method</code>
    </PossiblyUndefinedMethod>
  </file>
  <file src="tests/lib/OIDCLogoutHandlerTest.php">
    <MissingReturnType>
      <code>testCanHandle</code>
      <code>testNoStateFoundInSession</code>
      <code>testUnhandleableResponse</code>
      <code>testValidResponse</code>
    </MissingReturnType>
    <MixedMethodCall>
      <code>method</code>
    </MixedMethodCall>
    <PossiblyUndefinedMethod>
      <code>expects</code>
    </PossiblyUndefinedMethod>
  </file>
  <file src="tests/lib/Providers/AdjustableGenericProviderTest.php">
    <MissingParamType>
      <code>$expectedQueryString</code>
    </MissingParamType>
    <MissingReturnType>
      <code>testNoAdjustmentsToUrl</code>
      <code>testSetScopes</code>
    </MissingReturnType>
    <MixedInferredReturnType>
      <code>array</code>
    </MixedInferredReturnType>
  </file>
  <file src="tests/lib/Providers/OpenIDConnectProviderTest.php">
    <MissingParamType>
      <code>$expectedMessage</code>
      <code>$idToken</code>
    </MissingParamType>
    <MixedArgument>
      <code>$expectedMessage</code>
      <code>$idToken</code>
    </MixedArgument>
    <MixedInferredReturnType>
      <code>array</code>
    </MixedInferredReturnType>
    <PossiblyFalseOperand>
      <code>getenv('SIMPLESAMLPHP_CONFIG_DIR')</code>
    </PossiblyFalseOperand>
  </file>
</files>
